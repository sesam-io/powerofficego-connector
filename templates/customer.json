{
  "_id": "{{@ system @}}-{{@ datatype @}}-collect",
  "namespaced_identifiers": false,
  "source": {
    "id_expression": "{{ id }}",
    "operation": "list-{{@ datatype @}}",
    "operations": {
      "list-{{@ datatype @}}": {
        "method": "GET",
        "next_page_link": "{{@ base_url @}}/{{ properties.datatype|capitalize }}?$skip={{ (body.data is defined and body.data|length > 0 and properties.skip + '20') or '0' }}&$orderby={{ properties.ordering }}&$top={{ properties.top }}",
        "next_page_termination_strategy": [
          "next-page-link-empty",
          "empty-result"
        ],
        "params": {
          "$orderby": "Name asc",
          "$skip": 0,
          "$top": 20
        },
        "url": "/{{ properties.datatype|capitalize }}"
      }
    },
    "payload_property": "data",
    "properties": {
      "datatype": "{{@ datatype @}}",
      "ordering": "Name asc",
      "skip": "0",
      "top": "20"
    },
    "system": "{{@ system @}}",
    "type": "rest"
  },
  "type": "pipe"
}